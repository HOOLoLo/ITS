{"version":3,"sources":["../../src/interaction-test-runner.js"],"names":["TestRunner","DEFAULT_TEST_CASE","name","events","onBeforeEvents","deck","onAfterEvents","layers","context","sleep","timeout","Promise","resolve","window","setTimeout","InteractionTestRunner","testCase","onDone","promise","event","wait","then","browserTestDriver_emulateInput","layerManager","getLayers","_next"],"mappings":";;;;;;;;;;;;;;;;AAqBA,OAAOA,UAAP,MAAuB,eAAvB;AAEA,IAAMC,iBAAiB,GAAG;AACxBC,EAAAA,IAAI,EAAE,0BADkB;AAExBC,EAAAA,MAAM,EAAE,EAFgB;AAGxBC,EAAAA,cAAc,EAAE,8BAAY;AAAA,QAAVC,IAAU,QAAVA,IAAU;AAAE,GAHN;AAIxBC,EAAAA,aAAa,EAAE,8BAA6B;AAAA,QAA3BD,IAA2B,SAA3BA,IAA2B;AAAA,QAArBE,MAAqB,SAArBA,MAAqB;AAAA,QAAbC,OAAa,SAAbA,OAAa;AAAE;AAJtB,CAA1B;;AAOA,SAASC,KAAT,CAAeC,OAAf,EAAwB;AACtB,SAAO,IAAIC,OAAJ,CAAY,UAAAC,OAAO;AAAA,WAAIC,MAAM,CAACC,UAAP,CAAkBF,OAAlB,EAA2BF,OAA3B,CAAJ;AAAA,GAAnB,CAAP;AACD;;IAEoBK,qB;;;;;;;;;;;;;gCAOPC,Q,EAAUC,M,EAAQ;AAC5BD,MAAAA,QAAQ,CAACR,OAAT,GAAmBQ,QAAQ,CAACZ,cAAT,CAAwB;AACzCC,QAAAA,IAAI,EAAE,KAAKA;AAD8B,OAAxB,CAAnB;AAIA,UAAIa,OAAO,GAAGP,OAAO,CAACC,OAAR,EAAd;;AAL4B,iDAMRI,QAAQ,CAACb,MAND;AAAA;;AAAA;AAAA;AAAA,cAMjBgB,KANiB;;AAO1B,cAAIA,KAAK,CAACC,IAAV,EAAgB;AACdF,YAAAA,OAAO,GAAGA,OAAO,CAACG,IAAR,CAAa;AAAA,qBAAMZ,KAAK,CAACU,KAAK,CAACC,IAAP,CAAX;AAAA,aAAb,CAAV;AACD,WAFD,MAEO;AACLF,YAAAA,OAAO,GAAGA,OAAO,CAACG,IAAR,CAAa;AAAA,qBAAMR,MAAM,CAACS,8BAAP,CAAsCH,KAAtC,CAAN;AAAA,aAAb,CAAV;AACD;AAXyB;;AAM5B,4DAAqC;AAAA;AAMpC;AAZ2B;AAAA;AAAA;AAAA;AAAA;;AAa5B,aAAOD,OAAO,CAACG,IAAR,CAAaJ,MAAb,CAAP;AACD;;;2BAEMD,Q,EAAU;AACfA,MAAAA,QAAQ,CAACV,aAAT,CAAuB;AACrBD,QAAAA,IAAI,EAAE,KAAKA,IADU;AAErBE,QAAAA,MAAM,EAAE,KAAKF,IAAL,CAAUkB,YAAV,CAAuBC,SAAvB,EAFa;AAGrBhB,QAAAA,OAAO,EAAEQ,QAAQ,CAACR;AAHG,OAAvB;;AAKA,WAAKiB,KAAL;AACD;;;wBA7BqB;AACpB,aAAOxB,iBAAP;AACD;;;;EAHgDD,U;;SAA9Be,qB","sourcesContent":["// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/* global window */\nimport TestRunner from './test-runner';\n\nconst DEFAULT_TEST_CASE = {\n  name: 'Unnamed interaction test',\n  events: [],\n  onBeforeEvents: ({deck}) => {},\n  onAfterEvents: ({deck, layers, context}) => {}\n};\n\nfunction sleep(timeout) {\n  return new Promise(resolve => window.setTimeout(resolve, timeout));\n}\n\nexport default class InteractionTestRunner extends TestRunner {\n  get defaultTestCase() {\n    return DEFAULT_TEST_CASE;\n  }\n\n  // chain events\n  // TODO - switch to async/await\n  runTestCase(testCase, onDone) {\n    testCase.context = testCase.onBeforeEvents({\n      deck: this.deck\n    });\n\n    let promise = Promise.resolve();\n    for (const event of testCase.events) {\n      if (event.wait) {\n        promise = promise.then(() => sleep(event.wait));\n      } else {\n        promise = promise.then(() => window.browserTestDriver_emulateInput(event));\n      }\n    }\n    return promise.then(onDone);\n  }\n\n  assert(testCase) {\n    testCase.onAfterEvents({\n      deck: this.deck,\n      layers: this.deck.layerManager.getLayers(),\n      context: testCase.context\n    });\n    this._next();\n  }\n}\n"],"file":"interaction-test-runner.js"}